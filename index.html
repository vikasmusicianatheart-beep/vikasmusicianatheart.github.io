<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Excel Project Dashboard</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<!-- Custom CSS -->
<link rel="stylesheet" href="style.css">

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js" defer></script>
</head>

<body class="bg-light">

<div class="container py-4">

    <!-- Upload Box -->
    <div class="card mb-4 shadow-sm">
        <div class="card-body text-center">
            <h3>Upload Excel File</h3>
            <input type="file" id="excelFile" class="form-control mt-3" accept=".xlsx,.xls">
        </div>
    </div>

    <!-- Project Dashboard -->
    <div id="dashboard" style="display:none">

        <div class="card shadow-sm mb-4">
            <div class="card-body">
                <h3 class="mb-3">Project Dashboard</h3>

                <label class="form-label">Select Project</label>
                <select id="projectSelect" class="form-select mb-3"></select>

                <!-- Summary Cards -->
                <div class="row g-3">
                    <div class="col-md-3">
                        <div class="card text-center p-3 shadow-sm">
                            <h5>Total Credit</h5>
                            <h3 id="totalCredit" class="text-success">0</h3>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="card text-center p-3 shadow-sm">
                            <h5>Total Debit</h5>
                            <h3 id="totalDebit" class="text-danger">0</h3>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="card text-center p-3 shadow-sm">
                            <h5>Net Balance</h5>
                            <h3 id="netBalance">0</h3>
                        </div>
                    </div>

                    <div class="col-md-3">
                        <div class="card text-center p-3 shadow-sm">
                            <h5>Status</h5>
                            <h3 id="profitLoss">â€“</h3>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts -->
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="card p-3 shadow-sm">
                    <h5>Cash Flow Chart</h5>
                    <canvas id="cashFlowChart"></canvas>
                </div>
            </div>

            <div class="col-lg-6">
                <div class="card p-3 shadow-sm">
                    <h5>Category Chart</h5>
                    <canvas id="categoryChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Comparison Charts -->
        <h3 class="mt-5">Project Comparison</h3>

        <div class="row g-4 mt-1">
            <div class="col-md-6">
                <div class="card p-3 shadow-sm">
                    <h5>Profit/Loss Comparison</h5>
                    <canvas id="projectProfitChart"></canvas>
                </div>
            </div>

            <div class="col-md-6">
                <div class="card p-3 shadow-sm">
                    <h5>Credit vs Debit Comparison</h5>
                    <canvas id="creditDebitChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Transaction Table -->
        <div class="card mt-5 shadow-sm">
            <div class="card-body">
                <h4>Transactions</h4>
                <table class="table table-striped mt-3">
                    <thead class="table-dark">
                        <tr>
                            <th>Date</th><th>Title</th><th>Type</th><th>Amount</th><th>Category</th>
                        </tr>
                    </thead>
                    <tbody id="transactionTable"></tbody>
                </table>
            </div>
        </div>

    </div>
</div>

</body>
</html>
