<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Excel Project Dashboard</title>

<!-- Bootstrap -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

<link rel="stylesheet" href="style.css">

<!-- Libraries -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="script.js" defer></script>

</head>
<body class="bg-light">

<div class="container py-5">

    <!-- Excel Import Section -->
    <div id="dropZone" class="drop-zone shadow-sm">
        <h3><strong>Import Excel File</strong></h3>
        <p class="text-muted">Drag & drop .xlsx file here, or click to choose</p>
        <input type="file" id="fileInput" accept=".xlsx,.xls">
    </div>

    <!-- Dashboard -->
    <div id="dashboard" style="display:none">

        <h2 class="mb-4 fw-bold">Project Dashboard</h2>

        <!-- Project Selector -->
        <div class="mb-3">
            <label class="form-label">Select Project</label>
            <select id="projectSelect" class="form-select"></select>
        </div>

        <!-- Summary Cards -->
        <div class="row g-3 mb-4">
            <div class="col-md-3"><div class="card p-3 text-center"><h6>Total Credit</h6><h3 id="totalCredit">0</h3></div></div>
            <div class="col-md-3"><div class="card p-3 text-center"><h6>Total Debit</h6><h3 id="totalDebit">0</h3></div></div>
            <div class="col-md-3"><div class="card p-3 text-center"><h6>Net Balance</h6><h3 id="netBalance">0</h3></div></div>
            <div class="col-md-3"><div class="card p-3 text-center"><h6>Status</h6><h3 id="profitLoss">â€“</h3></div></div>
        </div>

        <!-- Charts -->
        <div class="row g-4">
            <div class="col-md-6">
                <div class="card p-3"><h5>Cash Flow</h5><canvas id="cashFlowChart"></canvas></div>
            </div>
            <div class="col-md-6">
                <div class="card p-3"><h5>Category Distribution</h5><canvas id="categoryChart"></canvas></div>
            </div>
        </div>

        <!-- Comparison Charts -->
        <h3 class="mt-5 mb-3 fw-bold">Project Comparison</h3>
        <div class="row g-4">
            <div class="col-md-6"><div class="card p-3"><h5>Profit/Loss</h5><canvas id="projectProfitChart"></canvas></div></div>
            <div class="col-md-6"><div class="card p-3"><h5>Credit vs Debit</h5><canvas id="creditDebitChart"></canvas></div></div>
        </div>

        <!-- Transactions -->
        <div class="card mt-5">
            <div class="card-body">
                <h4 class="mb-3">Transactions</h4>
                <table class="table table-striped">
                    <thead class="table-dark"><tr>
                        <th>Date</th><th>Title</th><th>Type</th><th>Amount</th><th>Category</th>
                    </tr></thead>
                    <tbody id="transactionTable"></tbody>
                </table>
            </div>
        </div>

    </div>

</div>

</body>
</html>
